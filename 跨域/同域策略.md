### **同源**的定义

源（origin）就是协议、域名和端口号。

下表为与 `http://api.a.com/user/cavie.html` 比较是否同源：

| URL                                   | 结果   | 原因                       |
| ------------------------------------- | ------ | -------------------------- |
| `http://api.a.com/user/test1.html`    | 同源   |                            |
| `http://api.a.com/shops/good1.html`   | 同源   |                            |
| `https://api.a.com/user/test1.html`   | 不同源 | 不同协议 ( https 和 http ) |
| `http://api.a.com:81/user/test1.html` | 不同源 | 不同端口 ( 81 和 80)       |
| `http://config.a.com/`                | 不同源 | 不同域名 ( api 和 config)  |



### 什么是同源策略

同源策略是浏览器的一个安全功能，不同源的客户端脚本在没有明确授权的情况下，不能读写对方资源。所以a.com 下的 js 脚本采用 ajax 读取 b.com里面的文件数据是会报错的。

不受同源策略限制的：

1. 页面中的链接，重定向以及表单提交是不会受到同源策略限制的。
2. 跨域资源的引入是可以的。但是 js 不能读写加载的内容。如嵌入到页面中的 `<script src="..."></script>，<img>，<link>，<iframe>` 等。



### 没有同源策略的危害

（一）CSRF 攻击

攻击者可以伪造你的身份去访问已经登录过的网站，从而获取到利益（操作/信息）。

例子：

1. 你登录了某个商城的账号，商城把你登录的状态存储到 Access-token 中（Cookie）。
2. 此时打开了一个攻击网站。
3. 如果没有同源策略保护，则该攻击网站可以内地里访问商城，此时浏览器会自动带上该 Access-token。从而达成了攻击网站伪造你去登录上了商城，并可以在商城做相关的操作（购买等）。



（二）Dom查询

钓鱼网站可已通过自己的网站中内嵌别的网站的资源，并通过 JS 读取内嵌网站的信息。

例子：

1. 某个钓鱼网站内嵌了其他网站进去（通过`<Iframe>`）
2. 若没有同源策略保护，该钓鱼网站就可以通过 js 去查询到页面中的 `<iframe>` 里的相关信息（例如某个登录表单的 `<input>` 值）

